# Bitrix24 Companies Fetcher

Приложение для получения списка компаний из Bitrix24 через REST API с использованием вебхука.

## Описание

Приложение получает до 10,000 компаний из Bitrix24 через REST API, используя пагинацию для обработки больших объемов данных. Результаты отображаются в удобном веб-интерфейсе.

## Технологии

- **Backend**: Node.js + Express
- **Frontend**: Vue.js 3
- **HTTP клиент**: Axios

## Установка

1. Клонируйте репозиторий или скачайте код
2. Установите зависимости:

```bash
npm install
```

## Использование

### Способ 1: Через веб-интерфейс

1. Запустите сервер:

```bash
npm start
```

2. Откройте браузер и перейдите по адресу: `http://localhost:3000`
3. Введите ваш вебхук Bitrix24 в поле ввода
4. Нажмите кнопку "Получить компании"
5. Дождитесь загрузки данных (может занять некоторое время для 10,000 записей)

### Способ 2: Через переменную окружения

1. Установите переменную окружения с вебхуком:

**Windows (PowerShell):**
```powershell
$env:BITRIX24_WEBHOOK="https://ваш-портал.bitrix24.ru/rest/1/ваш-код/"
npm start
```

**Windows (CMD):**
```cmd
set BITRIX24_WEBHOOK=https://ваш-портал.bitrix24.ru/rest/1/ваш-код/
npm start
```

**Linux/Mac:**
```bash
export BITRIX24_WEBHOOK="https://ваш-портал.bitrix24.ru/rest/1/ваш-код/"
npm start
```

2. Откройте браузер: `http://localhost:3000`
3. Нажмите "Получить компании" (вебхук будет использован из переменной окружения)

### Способ 3: Через API напрямую

```bash
curl -X POST http://localhost:3000/api/fetch-companies \
  -H "Content-Type: application/json" \
  -d '{"webhook": "https://ваш-портал.bitrix24.ru/rest/1/ваш-код/"}'
```

## Получение вебхука Bitrix24

1. Войдите в ваш Bitrix24
2. Перейдите в настройки приложений
3. Создайте входящий вебхук с правами доступа к CRM
4. Скопируйте URL вебхука (формат: `https://ваш-портал.bitrix24.ru/rest/1/код/`)

## Особенности

- **Пагинация**: Автоматическая обработка пагинации (Bitrix24 возвращает максимум 50 записей за раз)
- **Обработка ошибок**: Детальные сообщения об ошибках
- **Красивый UI**: Современный интерфейс с таблицей компаний
- **Производительность**: Оптимизированная загрузка данных с задержками между запросами

## Структура проекта

```
.
├── server.js          # Express сервер с API endpoints
├── package.json       # Зависимости проекта
├── public/
│   └── index.html    # Vue.js фронтенд
├── .gitignore
└── README.md
```

## API Endpoints

- `GET /` - Главная страница с интерфейсом
- `POST /api/fetch-companies` - Получение списка компаний
  - Body: `{ "webhook": "https://..." }`
  - Response: `{ "success": true, "count": 10000, "companies": [...] }`
- `GET /api/status` - Проверка статуса сервера

## Порт

По умолчанию приложение запускается на порту 3000. Для изменения используйте переменную окружения:

```bash
PORT=8080 npm start
```

## Требования

- Node.js 14.x или выше
- npm или yarn

## Лицензия

ISC

